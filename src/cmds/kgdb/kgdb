#! /bin/csh -f
#
#   Script to invoke the correct kgdb based on the specified -m option. 
#   All options other that -m are assumed to be kgdb options and are
#   passed unmodified to kgdb. Since this script is intended to run on
#   both unix and sprite, it uses unix style path names.
#
# $Header: /sprite/src/cmds/kgdb/RCS/kgdb,v 1.2 90/11/15 17:50:22 rab Exp $SPRITE (Berkeley)
#
# Copyright 1989 Regents of the University of California
# Permission to use, copy, modify, and distribute this
# software and its documentation for any purpose and without
# fee is hereby granted, provided that the above copyright
# notice appear in all copies.  The University of California
# makes no representations about the suitability of this
# software for any purpose.  It is provided "as is" without
# express or implied warranty.
#

# 
# Default to the machine type in the $MACHINE variable.
#
set tm = $MACHINE
if (($MACHINE == "ds3100") || ($MACHINE == "ds5000")) then
    set tm = "mips"

#
# Set the variable tm to the -m option specified.  This code assumes that if
# if it exists then the -m must be the first argument. argv is shifted to 
# remove the -m option.

if ($#argv > 0) then
        switch ($argv[1])
#
# Currently, sun3 and sun2 shared the same kdbx with tm=sun3.
#
        case -msun2:
        case -msun3:
	    set tm=sun3
            shift argv
	    goto out
	case -mspur:
	    set tm=spur
            shift argv
	    goto out
	case -msun4:
	    set tm=sun4
            shift argv
	    goto out
	case -msymm
	    set tm=symm
            shift argv
	    goto out
	case -mds3100
	    set tm=mips
            shift argv
	    goto out
	case -mds5000
	    set tm=mips
            shift argv
	    goto out
# 
# Added addition machine types here.  
        case -m*:
            echo "unknown machine" $argv[1]
            exit(1)
	default:
	endsw
endif

out:
echo "Sprite" $tm "kernel debugger"
exec kgdb.$tm $argv
